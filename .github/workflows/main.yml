name: Teste Actions Golang

on:
    push:
        branches:
            - test_actions

jobs:

    build:
        runs-on: ubuntu-latest
        
        defaults:
            run:
                shell: bash
                working-directory: ./sum_ints


        steps:
        - name: Checkout Code
          uses: actions/checkout@v4
          with: 
            sparse-checkout: |
                sum_ints
        
        - name: Setup Golang
          uses: actions/setup-go@v4
          with:
            go-version: '1.24.0'
            
        #- name: Install Dependencies
        #  run: go mod tidy

        - name: Build the Go Binary
          run: GOOS=linux GOARCH=amd64 go build -o bootstrap main.go

        - name: Valida o diret칩rio
          run: ls -R

        - name: Upload Go Binary
          uses: actions/upload-artifact@v4
          with: 
            name: bootstrap
            path: sum_ints/bootstrap

        # -------------- testes bin치rio -----------------

    testa_binario:
        needs: build
        runs-on: ubuntu-latest

        defaults:
            run:
                shell: bash

        steps:
        - name: Download Go Binary from build
          uses: actions/download-artifact@v4
          with:
            name: bootstrap
            path: .

        - name: Display downloaded bin
          run: ls -R

        - name: Testa existencia do binario
          run: test -f bootstrap

        - name: Exibe info do bin치rio
          run: file bootstrap

        - name: Executa bin치rio 
          run: ./bootstrap